"use strict";var r=Object.create;var n=Object.defineProperty;var o=Object.getOwnPropertyDescriptor;var l=Object.getOwnPropertyNames;var u=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var p=(e,t,a,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of l(t))!h.call(e,s)&&s!==a&&n(e,s,{get:()=>t[s],enumerable:!(i=o(t,s))||i.enumerable});return e};var c=(e,t,a)=>(a=e!=null?r(u(e)):{},p(t||!e||!e.__esModule?n(a,"default",{value:e,enumerable:!0}):a,e));Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const f=require("../BaseButton/BaseButton.vue.cjs.js"),x=require("./BaseExpandListRow.vue.cjs.js");require("./BaseExpandList.vue.cjs2.js");const b=require("../../_virtual/_plugin-vue2_normalizer.cjs.js"),m={name:"BaseExpandList",components:{BaseButton:f.default,BaseExpandListRow:x.default,Draggable:()=>import("vuedraggable").then(e=>e.default||e)},props:{data:{type:Array,default:()=>[]},edit:{type:Boolean,default:!1},minItems:{type:Number,default:3},multiple:{type:Boolean,default:!1},showMoreText:{type:String,default:"Show all"},showLessText:{type:String,default:"Show less"},editHideText:{type:String,default:"Hide"},editShowText:{type:String,default:"Show"},assistiveText:{type:Object,default:()=>({activate:"Use the Enter key to select item. Item is currently {state}",activated:"Item selected. Use arrow keys to order item.",description:"Use Tab key to navigate to item an order item.",moved:"Item moved: {pos} of {total}",visible:"visible",hidden:"hidden"}),validator:e=>Object.keys(e).every(t=>["activate","activated","description","moved","visible","hidden"].includes(t))},controlType:{type:String,default:"button",validator:e=>["button","toggle"].includes(e)},expanded:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},data(){return{assertiveText:"",showAll:!1,dataSorted:null,originalData:null,dragHandle:""}},computed:{dataInt:{get(){return this.dataSorted||this.data},set(e){this.dataSorted=e}}},watch:{dataSorted:{handler(e){this.edit&&JSON.stringify(e)!==JSON.stringify(this.data)&&this.$emit("update:data",e)},deep:!0},data:{handler(e){JSON.stringify(e)!==JSON.stringify(this.dataSorted)&&(this.dataInt=JSON.parse(JSON.stringify(e)))},deep:!0,immediate:!0},edit(e){this.assertiveText="",e&&(this.$nextTick(()=>{this.$refs.baseExpandListDraggable.focus({preventScroll:!0})}),this.originalData=JSON.parse(JSON.stringify(this.data)))},expanded(e){this.expandItems(e)}},mounted(){this.dragHandle=this.isTouchCapable()?[".base-expand-item__handle"]:[".base-expand-item__handle",".base-expand-item__label"]},methods:{expandItems(e){e.length&&(e[0]>=this.minItems&&this.$refs.baseExpandListRow[e[0]]&&(this.showAll=!0),e[0]!==void 0&&this.$refs.baseExpandListRow[e[0]]&&(this.$refs.baseExpandListRow[e[0]].expanded=!0),e[1]!==void 0&&this.$refs.baseExpandListRow[e[0]].$refs.baseExpandListRow[e[1]]&&(this.$refs.baseExpandListRow[e[0]].$refs.baseExpandListRow[e[1]].expanded=!0))},emitExpandedState(e){this.$emit("expanded-state",e)},updateData(e,t){this.$set(this.dataSorted,t,e)},sort({direction:e},t){if(e==="up"&&t-1<0||e==="down"&&t+1>=this.dataInt.length){this.$refs.baseExpandListRow[t].useAssistiveText=!1,this.$refs.baseExpandListRow[t].movable=!0;return}const a=e==="up"?t-1:t+1,i=t,s=this.dataInt;s.splice(a,0,s.splice(i,1)[0]),this.dataInt=s,this.assertiveText=this.assistiveText.moved.replace("{pos}",a+1).replace("{total}",this.dataInt.length),this.$refs.baseExpandListRow[a].useAssistiveText=!1,this.$refs.baseExpandListRow[a].movable=!0},reset(){this.dataInt=JSON.parse(JSON.stringify(this.originalData)),this.$emit("update:data",this.dataInt)},save(){this.$emit("saved",this.dataInt),this.originalData=JSON.parse(JSON.stringify(this.dataInt))},assistive(e,t){const a=this.dataInt[t].hidden?this.assistiveText.hidden:this.assistiveText.visible,i=this.assistiveText[e].replace("{state}",a);if(this.assertiveText===i){this.assertiveText="",setTimeout(()=>{this.assertiveText=i},1);return}this.assertiveText=i},isTouchCapable(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0}}};var v=function(){var t=this,a=t._self._c;return a("div",{staticClass:"base-expand-list"},[a("div",{class:["base-box-shadow",{"base-box-shadow--edit":t.edit}]},[t.edit?t._e():a("ul",t._l(t.data,function(i,s){return a("BaseExpandListRow",{directives:[{name:"show",rawName:"v-show",value:s<(t.showAll?t.data.length:t.minItems),expression:"index < (showAll ? data.length : minItems)"}],key:s,ref:"baseExpandListRow",refInFor:!0,attrs:{"parent-index":s,data:i,multiple:t.multiple,"render-as":"li"},on:{"expanded-state":t.emitExpandedState},scopedSlots:t._u([{key:"content",fn:function(d){return[t._t("content",null,{data:d.data})]}}],null,!0)})}),1),t.edit?[a("div",{staticClass:"assistive-text",attrs:{"aria-live":"assertive"}},[t._v(" "+t._s(t.assertiveText)+" ")]),a("p",{staticClass:"assistive-text",attrs:{id:`draggable-${t._uid}`}},[t._v(" "+t._s(t.assistiveText.description)+" ")]),a("div",{ref:"baseExpandListDraggable",staticClass:"base-expand-list__draggable",attrs:{tabindex:"0","aria-labelledby":`draggable-${t._uid}`}},[a("draggable",{staticClass:"base-expand-list__draggable",attrs:{draggable:".base-expand-list__draggable__item",handle:t.dragHandle,disabled:t.disabled,animation:"150"},model:{value:t.dataInt,callback:function(i){t.dataInt=i},expression:"dataInt"}},t._l(t.dataInt,function(i,s){return a("BaseExpandListRow",{key:s,ref:"baseExpandListRow",refInFor:!0,staticClass:"base-expand-list__draggable__item",attrs:{data:i,edit:!0,"edit-hide-text":t.editHideText,"edit-show-text":t.editShowText,"control-type":t.controlType,disabled:t.disabled},on:{assistive:function(d){return t.assistive(d,s)},sorted:function(d){return t.sort(d,s)},"update:data":function(d){return t.updateData(d,s)}}})}),1)],1)]:t._e()],2),!t.edit&&t.data.length>t.minItems?a("BaseButton",{class:{"base-button-icon-rotate-180":t.showAll},attrs:{id:`base-expand-list-${t._uid}`,"aria-expanded":t.showAll?"true":"false","has-background-color":!1,icon:"drop-down","icon-position":"right",text:t.showAll?t.showLessText:t.showMoreText},on:{clicked:function(i){t.showAll=!t.showAll}}}):t._e()],1)},g=[],w=b.default(m,v,g,!1,null,"6ee40e22",null,null);const _=w.exports;exports.default=_;
//# sourceMappingURL=BaseExpandList.vue.cjs.js.map
