"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const f=require("../BaseIcon/BaseIcon.vue.cjs.js"),m=require("./BaseCollapsedFilterItem.vue.cjs.js"),u=require("../../utils/utils.cjs.js");require("./BaseCollapsedFilterRow.vue.cjs2.js");const p=require("../../_virtual/_plugin-vue2_normalizer.cjs.js"),b={name:"BaseCollapsedFilterRow",components:{BaseCollapsedFilterItem:m.default,BaseIcon:f.default},props:{filters:{type:Array,default:()=>[],validator:t=>{const e=["idInternal","labelInternal","filter_values"],s=["values","fieldType","fieldId"];return!t.some(l=>{const a=Object.keys(l),n=Object.keys(l.filter_values);let r=e.some(i=>!a.includes(i));return r||(r=s.some(i=>!n.includes(i)),r||(r=l.filter_values.values.some(i=>{var o;if(((o=i==null?void 0:i.values)==null?void 0:o.length)>=0){const c=Object.keys(i);return i.values.length!==0&&s.some(d=>!c.includes(d))&&i.values.some(d=>!Object.keys(d).includes("labelInternal"))}return!Object.keys(i).includes("labelInternal")}))),r})}},dateTimeText:{type:Object,default:()=>({from:"from",until:"until",range:"to"}),validator:t=>!["from","until","range"].some(e=>!Object.keys(t).includes(e))},interpretLabelAsHtml:{type:[Boolean,Array],default:!1},assistiveText:{type:Object,default:()=>({removeFiltersLabel:"Remove all filters.",filterRemovedNotification:"Filter value {value} was removed from filter {label}.",appliedFiltersLabel:"Currently applied Filters",booleanFilterLabel:"Filter {label} was set",optionToRemoveSelected:"Press delete or backspace to remove."})}},data(){return{filtersInt:[],filterFade:{left:!1,right:!0},pos:{top:0,left:0,x:0,y:0},scrollContainer:null,isScrolling:!1,resizeObserver:null,chipRemovedAssistiveText:""}},computed:{filterListScrollable(){return this.filterFade.right||this.filterFade.left}},watch:{filters:{handler(t){JSON.stringify(t)!==JSON.stringify(this.filtersInt)&&(this.filtersInt=JSON.parse(JSON.stringify(t)))},immediate:!0},filtersInt:{handler(t){JSON.stringify(t)!==JSON.stringify(this.filters)&&this.$emit("update:filters",[...t]),this.$nextTick(()=>this.calcFadeOut())},deep:!0}},mounted(){this.$refs.filterList&&(this.scrollContainer=this.$refs.filterList),this.initResizeObserver()},beforeDestroy(){this.resizeObserver&&this.resizeObserver.unobserve(this.$refs.filterList)},methods:{removeFilters(){this.$emit("remove-all")},removeChip(t,e,s){const{fieldType:l,values:a}=this.filtersInt[t].filter_values,n=this.filtersInt[t].labelInternal,r=l==="group"?a[e].values[s].labelInternal:a[e].labelInternal;if(l==="group"){const i=a.reduce((o,{values:c})=>o.concat(c.filter(d=>u.hasData(d))),[]);i.length<2&&this.filtersInt.length<2?this.removeFilters():i.length>1?a[e].fieldType.includes("date")||a[e].fieldType.includes("time")?this.filtersInt[t].filter_values.values[e].values[s].labelInternal="":this.filtersInt[t].filter_values.values[e].values.splice(s,1):this.filtersInt.splice(t,1)}else this.filtersInt.length===1&&a.length===1?this.removeFilters():a.length===1?this.filtersInt.splice(t,1):l.includes("date")||l.includes("time")?a.filter(i=>u.hasData(i)).length<2?this.filtersInt.splice(t,1):this.filtersInt[t].filter_values.values[e].labelInternal="":this.filtersInt[t].filter_values.values.splice(e,1);this.chipRemovedAssistiveText=this.assistiveText.filterRemovedNotification.replace("{label}",n).replace("{value}",r),setTimeout(()=>{this.chipRemovedAssistiveText=""},300)},initResizeObserver(){const t=new ResizeObserver(this.calcFadeOut);t.observe(this.$refs.filterList),this.resizeObserver=t},mouseDownHandler(t){var e,s;this.filterListScrollable&&(this.pos={left:this.scrollContainer.scrollLeft,top:this.scrollContainer.scrollTop,x:t.clientX??(t.touches?(e=t.touches[0])==null?void 0:e.clientX:0),y:t.clientY??(t.touches?(s=t.touches[0])==null?void 0:s.clientY:0)},t.type==="touchstart"?(document.addEventListener("touchmove",this.mouseMoveHandler),document.addEventListener("touchend",this.mouseUpHandler)):(document.addEventListener("mousemove",this.mouseMoveHandler),document.addEventListener("mouseup",this.mouseUpHandler)),this.isScrolling=!0)},mouseMoveHandler(t){var n,r;const e=t.clientX??(t.touches?(n=t.touches[0])==null?void 0:n.clientX:0),s=t.clientY??(t.touches?(r=t.touches[0])==null?void 0:r.clientY:0),l=e-this.pos.x,a=s-this.pos.y;this.scrollContainer.scrollTop=this.pos.top-a,this.scrollContainer.scrollLeft=this.pos.left-l,this.calcFadeOut()},mouseUpHandler(){document.removeEventListener("mousemove",this.mouseMoveHandler),document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("touchmove",this.mouseMoveHandler),document.removeEventListener("touchend",this.mouseUpHandler),this.isScrolling=!1},calcFadeOut(){const t=Math.floor(this.scrollContainer.scrollLeft),e=this.scrollContainer.scrollWidth-this.scrollContainer.clientWidth;this.filterFade={left:t!==0,right:e!==0&&t!==e}},filterValuesHaveData(t){return u.hasData(t)},getRangeIndicator(t,e){if(t.values.length===2&&["date","time"].includes(t.fieldType)){if(t.values[0].labelInternal&&t.values[1].labelInternal&&e===1)return this.dateTimeText.range;if(!t.values[1].labelInternal&&t.values[0].labelInternal)return this.dateTimeText.from;if(!t.values[0].labelInternal&&t.values[1].labelInternal)return this.dateTimeText.until}return""},calcSubFormChipHtmlRender(t,e){const s=t.split("-").slice(0,1).join("-"),l=this.interpretLabelAsHtml.find(a=>typeof a=="object"&&Object.keys(a).includes(s));return!!l&&l[s].includes(e)}}};var h=function(){var e=this,s=e._self._c;return s("div",{staticClass:"base-collapsed-filter-row"},[s("div",{ref:"filterListContainer",class:["base-collapsed-filter-row__filter-list-container",{"base-collapsed-filter-row__filter-list-container__fade-right":e.filterFade.right},{"base-collapsed-filter-row__filter-list-container__fade-left":e.filterFade.left}]},[s("ul",{ref:"filterList",class:["base-collapsed-filter-row__filter-list",{"base-collapsed-filter-row__filter-list__scrollable":e.filterListScrollable},{"base-collapsed-filter-row__filter-list__scrolling":e.isScrolling}],attrs:{"aria-description":e.assistiveText.appliedFiltersLabel},on:{mousedown:e.mouseDownHandler,touchstart:e.mouseDownHandler}},e._l(e.filtersInt,function(l,a){var n;return s("li",{key:l.idInternal,class:["base-collapsed-filter-row__filter",{"base-collapsed-filter-row__filter__boolean":l.filter_values.fieldType==="boolean"}],attrs:{"aria-describedby":`${l.idInternal}-label`,role:"listitem",tabindex:"0"}},[l.filter_values&&e.filterValuesHaveData(l.filter_values.values)?[s("div",{staticClass:"base-collapsed-filter-row__filter-label",attrs:{id:`${l.idInternal}-label`}},[e._v(" "+e._s(l.labelInternal)+" ")]),s("ul",{staticClass:"base-collapsed-filter-row__chips-list"},[e._l((n=l.filter_values)==null?void 0:n.values,function(r,i){return[l.filter_values.fieldType==="group"?[e._l(r.values,function(o,c){return[o.labelInternal?s("BaseCollapsedFilterItem",{key:o.idInternal||`${o.labelInternal}-${i}-${c}`,attrs:{value:o,type:r.fieldType,"range-indicator":e.getRangeIndicator(r,c),scrollable:e.filterListScrollable,"is-scrolling":e.isScrolling,"date-time-text":e.dateTimeText,"interpret-label-as-html":typeof e.interpretLabelAsHtml=="boolean"&&e.interpretLabelAsHtml||typeof e.interpretLabelAsHtml=="object"&&e.calcSubFormChipHtmlRender(l.idInternal,r.fieldId),"assistive-text":{booleanFilterLabel:e.assistiveText.booleanFilterLabel?e.assistiveText.booleanFilterLabel.replace("{label}",l.labelInternal):o.labelInternal.toString(),optionToRemoveSelected:e.assistiveText.optionToRemoveSelected}},on:{"remove-chip":function(d){return e.removeChip(a,i,c)}}}):e._e()]})]:[r.labelInternal?s("BaseCollapsedFilterItem",{key:r.idInternal||`${r.labelInternal}-${i}`,attrs:{value:r,type:l.filter_values.fieldType,"range-indicator":e.getRangeIndicator(l.filter_values,i),scrollable:e.filterListScrollable,"is-scrolling":e.isScrolling,"date-time-text":e.dateTimeText,"interpret-label-as-html":typeof e.interpretLabelAsHtml=="boolean"&&e.interpretLabelAsHtml||typeof e.interpretLabelAsHtml=="object"&&e.interpretLabelAsHtml.includes(l.idInternal),"assistive-text":{booleanFilterLabel:e.assistiveText.booleanFilterLabel?e.assistiveText.booleanFilterLabel.replace("{label}",l.labelInternal):r.labelInternal.toString(),optionToRemoveSelected:e.assistiveText.optionToRemoveSelected}},on:{"remove-chip":function(o){return e.removeChip(a,i)}}}):e._e()]]})],2)]:e._e()],2)}),0)]),e.chipRemovedAssistiveText?s("span",{staticClass:"assistive-text",attrs:{"aria-live":"assertive"}},[e._v(" "+e._s(e.chipRemovedAssistiveText)+" ")]):e._e(),s("button",{staticClass:"base-collapsed-filter-row__remove",attrs:{title:e.assistiveText.removeFiltersLabel},on:{click:e.removeFilters}},[s("BaseIcon",{staticClass:"base-collapsed-filter-row__remove-icon",attrs:{name:"remove"}})],1)])},v=[],_=p.default(b,h,v,!1,null,"23cce083",null,null);const y=_.exports;exports.default=y;
//# sourceMappingURL=BaseCollapsedFilterRow.vue.cjs.js.map
