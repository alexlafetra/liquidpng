"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("../BaseSearch/BaseSearch.vue.cjs.js"),p=require("../BaseIcon/BaseIcon.vue.cjs.js"),h=require("../BaseButton/BaseButton.vue.cjs.js"),f=require("../BaseChipsInputField/BaseChipsInputField.vue.cjs.js"),y=require("../BaseChip/BaseChip.vue.cjs.js"),m=require("../BaseDropDownList/BaseDropDownList.vue.cjs.js"),u=require("../../utils/utils.cjs.js"),v=require("vue"),b=require("../../composables/useAnnouncer.cjs.js"),_=require("../../mixins/navigateList.cjs.js"),g=require("../../mixins/i18n.cjs.js");require("./BaseAdvancedSearchRow.vue.cjs2.js");require("./BaseAdvancedSearchRow.vue.cjs3.js");const w=require("../../_virtual/_plugin-vue2_normalizer.cjs.js"),I={name:"BaseAdvancedSearchRow",components:{BaseButton:h.default,BaseDropDownList:m.default,BaseChip:y.default,BaseChipsInputField:f.default,BaseSearch:d.default,BaseIcon:p.default},mixins:[_.default,g.default],props:{searchRowId:{type:String,default:""},mode:{type:String,default:"list",validator:t=>["list","form"].includes(t)},isMainSearch:{type:Boolean,default:!0},filterList:{type:Array,default:()=>[],validator:t=>!t.length||t.every(e=>!!e.type&&(!["chips","chipssingle"].includes(e.type)||e.freetext_allowed||!!e.options))},defaultFilter:{type:Object,default:()=>({id:"default",label:"Fulltext",type:"text",options:[]}),validator:t=>!t.length||t.every(e=>!!e.type&&(!["chips","chipssingle"].includes(e.type)||e.freetext_allowed||!!e.options))},appliedFilter:{type:[Object,null],default:null,validator:t=>t===null||!t.length||["id","type","label"].every(e=>Object.keys(t).includes(e))},autocompleteResults:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},language:{type:String,default:""},identifierPropertyName:{type:[Object,String],default:()=>({filter:"id",autocompleteOption:"id",controlledVocabularyOption:"id"})},labelPropertyName:{type:[Object,String],default:()=>({filter:"label",autocompleteOption:"title",controlledVocabularyOption:"label"})},autocompletePropertyNames:{type:Object,default:()=>({label:"label",id:"id",data:"data"}),validator:t=>["label","id","data"].every(e=>Object.keys(t).includes(e))},placeholder:{type:[String,Object],default:"Search and discover"},advancedSearchText:{type:Object,default:()=>({title:"Advanced Search",subtext:"Select a filter",availableOptions:"Available options"})},dropDownInfoTexts:{type:Object,default:()=>({autocompleteNoOptions:"No matching options found",autocompleteOngoing:"Autocomplete is being fetched...",autocompleteInitial:"Please start typing or select a filter to see options",chipsNoOptions:"No more options available",chipsMaxOptions:"Please start typing to see options",chipsNoMatch:"No matching options were found",chipsOngoing:"Options are being loaded..."}),validator:t=>["autocompleteNoOptions","autocompleteOngoing","autocompleteInitial","chipsNoOptions","chipsOngoing","chipsMaxOptions","chipsNoMatch"].every(e=>Object.keys(t).includes(e))},maxNumberControlledOptions:{type:Number,default:100},assistiveText:{type:Object,default:()=>({addFilter:"Add filter",removeFilter:"Remove filter",selectFilterLabel:"Select filter",searchLabel:"Search for Entries",selectedOption:"",loaderActive:"loading.",autocompleteResultsRetrieved:"{optionsNumber} options found in {collectionsNumber} categories.",autocompleteNoResults:"No results found.",autocompleteInitial:"Please start typing to see suggestions.",categoryAnnouncement:"category {label}.",optionsAnnouncement:"{number} options.",results:""})},applyBoxShadow:{type:Boolean,default:!0},dateFieldDelay:{type:Number,default:0},highlightAutocompleteMatch:{type:Boolean,default:!1},highlightAutocompleteTags:{type:Array,default:()=>[]}},setup(){const t=v.ref(null),{announcement:e}=b.useAnnouncer(t);return{advancedSearchRow:t,announcement:e}},data(){return{currentInput:"",filter:null,activeFilter:null,filterFade:{left:!1,right:!0},activeCollectionId:"",collectionSelect:!1,activeControlledVocabularyEntry:null,activeEntry:null,isActive:!1,currentFilterType:this.appliedFilter?this.appliedFilter.type:this.defaultFilter.type,searchInputElement:null,observer:null,resizeObserver:null,filterSlotName:"pre-input-field",stopSearchClick:!1}},computed:{internalRowId(){return this.searchRowId||u.createId()},selectedFilter:{set(t){const e=t.length?t.pop():this.defaultFilter;this.filter={...e,filter_values:this.setFilterValues(e,this.filter)}},get(){return[this.filter]}},displayFilterList(){return this.isMainSearch?this.filterList.filter(t=>t[this.identifierPropertyName.filter]!==this.defaultFilter[[this.identifierPropertyName.filter]]):this.filterList},useAutocompleteFunctionality(){const{type:t}=this.filter;return t==="text"||t==="chips"&&this.filter.freetext_allowed},selectedOptions:{set(t){this.$set(this.filter,"filter_values",[...t])},get(){return this.filter.type.includes("chips")?this.filter&&this.filter.filter_values?[...this.filter.filter_values]:[]:[]}},controlledVocabularyOptions(){if(this.filter.type==="chips"&&!this.filter.freetext_allowed){const t=this.filterList.find(e=>e[this.identifierPropertyName.filter]===this.filter[this.identifierPropertyName.filter]);return t?t.options:[]}return[]},displayedOptions(){if(this.controlledVocabularyOptions){let t=[].concat(this.controlledVocabularyOptions);return this.filter.filter_values&&this.filter.filter_values.length&&(t=t.filter(e=>!this.filter.filter_values.map(s=>s[this.identifierPropertyName.controlledVocabularyOption]).includes(e[this.identifierPropertyName.controlledVocabularyOption]))),this.currentInput&&(t=t.filter(e=>e[this.labelPropertyName.filter].toLowerCase().includes(this.currentInput.toLowerCase()))),u.sort(t,this.labelPropertyName.controlledVocabularyOption,!1,this.getLangLabel)}return[]},resultListInt(){if(this.useAutocompleteFunctionality){let t=this.autocompleteResults;if(this.filter[this.identifierPropertyName.filter]!==this.defaultFilter[this.identifierPropertyName.filter]&&(t=t.filter(e=>e[this.autocompletePropertyNames.id]===this.filter[this.identifierPropertyName.filter]||this.filter.subsets&&this.filter.subsets.length&&this.filter.subsets.includes(e[this.autocompletePropertyNames.id]))),t=t.filter(e=>e[this.autocompletePropertyNames.data]&&e[this.autocompletePropertyNames.data].length),this.selectedOptions&&this.selectedOptions.length){const e=this.selectedOptions.map(s=>s[this.identifierPropertyName.autocompleteOption]);return t.map(s=>({data:s[this.autocompletePropertyNames.data].filter(i=>!e.includes(i[this.identifierPropertyName.autocompleteOption])),[this.autocompletePropertyNames.id]:s[this.autocompletePropertyNames.id],[this.autocompletePropertyNames.label]:s[this.autocompletePropertyNames.label]}))}return t}return[]},consolidatedResultList(){return this.resultListInt.reduce((t,e)=>(this.$set(t,e[this.autocompletePropertyNames.id],e[this.autocompletePropertyNames.data]),t),{})},filterHasValues(){return this.filter[this.identifierPropertyName.filter]!==this.defaultFilter[this.identifierPropertyName.filter]||u.hasData(this.filter.filter_values)},searchType(){if(this.filter){const{type:t}=this.filter;return t==="chips"&&!this.filter.freetext_allowed?"controlled":t}return"text"}},watch:{filter:{handler(t){JSON.stringify(t)!==JSON.stringify(this.appliedFilter)&&this.$emit("update:applied-filter",{...t})},deep:!0},defaultFilter:{handler(t){(!this.filter||this.filter.id==="default")&&(this.filter={...t,filter_values:this.setFilterValues(t)})},immediate:!0},appliedFilter:{handler(t){if(JSON.stringify(t)!==JSON.stringify(this.filter)){const e=t||this.defaultFilter;this.filter={...e,filter_values:e.filter_values||this.setFilterValues(e)},t&&t.filter_values?t.type.includes("date")?this.currentInput=t.filter_values:t.type==="text"?this.currentInput=t.filter_values[0]||"":this.currentInput="":this.currentInput=""}},immediate:!0,deep:!0},currentInput:{handler(t){this.useAutocompleteFunctionality&&this.$emit("fetch-autocomplete-results",{input:t,filter:this.filter})},immediate:!0},isActive(t){t&&(this.filterFade={left:!1,right:!0},this.activeEntry||setTimeout(()=>{this.isActive&&this.assembleAutocompleteResultsAnnouncement()},300)),!t&&this.filter.type==="chips"&&this.currentInput&&this.currentInput.trim()?this.filter.freetext_allowed&&(!this.selectedOptions||!this.selectedOptions.some(e=>!e[this.identifierPropertyName.autocompleteOption]&&e[this.labelPropertyName.autocompleteOption]===this.currentInput))?this.addOption({[this.labelPropertyName.autocompleteOption]:this.currentInput}):this.resetAllInput():!t&&this.filter.type==="text"&&this.filter.filter_values.join()!==this.currentInput&&this.addOption(this.currentInput),this.$emit("is-active",t)},autocompleteResults(){this.activeEntry=null,this.activeCollectionId="",this.isActive&&this.assembleAutocompleteResultsAnnouncement()},displayedOptions(){this.activeControlledVocabularyEntry=null}},mounted(){this.getSearchInputElement(),this.initObservers()},updated(){this.$refs.filterBox&&this.$refs.filterBox.addEventListener("scroll",this.calcFadeOut)},beforeDestroy(){this.resizeObserver&&this.resizeObserver.unobserve(this.$refs.advancedSearchRow)},destroyed(){this.$refs.filterBox&&this.$refs.filterBox.removeEventListener("scroll",this.calcFadeOut)},methods:{addFilterRow(){this.$emit("add-filter-row",{filter:this.filter,input:this.currentInput})},removeFilter(){this.isMainSearch?(this.filter={...this.defaultFilter,filter_values:this.setFilterValues(this.defaultFilter)},this.resetAllInput(),this.isActive=!1):this.$emit("remove-filter",this.filter)},selectFilter(t){if(t&&this.filter[this.identifierPropertyName.filter]!==t[this.identifierPropertyName.filter]){const e=this.filter,s=this.currentInput;this.filter={...t,filter_values:this.setFilterValues(t,e)},this.resetAllInput(),this.activeFilter=null,["text","chips"].includes(t.type)&&["text","chips"].includes(e.type)&&!(e.type==="text"&&e.filter_values[0]===s)&&(this.currentInput=s,(t.type==="text"||t.type==="chips"&&t.freetext_allowed)&&this.currentInput&&!this.autocompleteResults.some(i=>i.filter_id===t.id)&&this.$emit("fetch-autocomplete-results",{input:this.currentInput,filter:this.filter})),this.filter.type.includes("date")&&(this.currentInput=this.filter.filter_values),this.filter.type==="chipssingle"&&this.addOption(this.filter.options[0])}this.searchInputElement&&this.searchInputElement.focus()},navigateFilters(t){if(this.filterList.length&&this.isActive&&this.$refs.dropDown){const e=this.filterList.indexOf(this.activeFilter),s=this.$refs.dropDown.$el;this.$refs.filterOption&&s.scrollTop!==0&&this.$refs.dropDown.$el.scrollTo({top:0});const i=t.key==="ArrowDown";this.activeFilter=this.navigate(this.filterList,i,e,!0)}},addOption(t,e=""){const s=e||this.defaultFilter[this.identifierPropertyName.filter];if(!this.filterList||!this.filterList.length)this.$emit("option-selected",{entry:t,collectionId:s}),s!==this.defaultFilter[this.identifierPropertyName.filter]&&this.resetAllInput();else if(this.useAutocompleteFunctionality&&t[this.identifierPropertyName.autocompleteOption]&&this.filter[this.identifierPropertyName.filter]!==s&&!(this.filter.subsets&&this.filter.subsets.length&&this.filter.subsets.includes(s))){const i=this.filterList.find(a=>a[this.identifierPropertyName.filter]===(this.activeCollectionId||e))||this.defaultFilter,l=i[this.identifierPropertyName.filter]===this.defaultFilter[this.identifierPropertyName.filter]?[].concat(t[this.labelPropertyName.autocompleteOption]):[].concat(t),r=this.filter.filter_values&&this.filter.filter_values.length===1&&typeof this.filter.filter_values[0]=="string"?[{[this.labelPropertyName.autocompleteOption]:this.filter.filter_values[0]}]:[];this.filter={...i,filter_values:r.concat(l)}}else this.selectedOptions=this.filter.filter_values.concat(t);this.filter.type!=="text"&&(this.filter.type!=="chips"||this.filter.freetext_allowed||!this.displayedOptions.length)?this.resetAllInput():this.activeControlledVocabularyEntry=null,(this.filter.type!=="chips"||this.filter.freetext_allowed)&&(this.isActive=!1)},selectOptionOnKeyEnter(){if(this.filter.type==="chips"&&this.activeControlledVocabularyEntry)this.addOption(this.activeControlledVocabularyEntry);else if(this.useAutocompleteFunctionality&&this.activeEntry)this.addOption(this.activeEntry,this.activeCollectionId);else if(this.filter.type==="text"){const t=[].concat(this.currentInput);JSON.stringify(this.filter.filter_values)!==JSON.stringify(t)?(this.$set(this.filter,"filter_values",[].concat(this.currentInput)),this.isActive=!1):this.isActive=!this.isActive}else this.filter.type==="chips"&&this.filter.freetext_allowed&&this.currentInput&&this.currentInput.trim()&&(!this.selectedOptions||!this.selectedOptions.some(t=>!t[this.identifierPropertyName.autocompleteOption]&&t[this.labelPropertyName.autocompleteOption]===this.currentInput))?this.addOption({[this.labelPropertyName.autocompleteOption]:this.currentInput}):this.currentInput||(this.isActive=!this.isActive)},handleKeyDownEvent(t){const{key:e}=t;["Tab","Enter"," ","Shift"].includes(e)?e===" "&&!this.currentInput&&(this.isActive=!this.isActive,t.preventDefault()):this.isActive=!0},assembleAutocompleteResultsAnnouncement(){if(this.resultListInt.length&&this.assistiveText.autocompleteResultsRetrieved){const t=this.resultListInt.reduce((e,s)=>e+s.data.length,0);this.announcement=this.assistiveText.autocompleteResultsRetrieved.replace("{optionsNumber}",t.toString()).replace("{collectionsNumber}",this.resultListInt.length.toString())}else!this.resultListInt.length&&this.currentInput&&this.assistiveText.autocompleteNoResults?this.announcement=this.assistiveText.autocompleteNoResults:!this.resultListInt.length&&!this.currentInput&&this.assistiveText.autocompleteInitial&&(this.announcement=this.assistiveText.autocompleteInitial)},openDropDown(){!this.isActive&&this.mode==="list"&&this.searchInputElement&&this.searchInputElement.focus(),this.isActive=!0},navigateDropDown(t){t.preventDefault();const e=t.key==="ArrowDown";if(this.controlledVocabularyOptions&&this.controlledVocabularyOptions.length&&(t.key==="ArrowDown"||t.key==="ArrowUp")){const s=this.displayedOptions.indexOf(this.activeControlledVocabularyEntry);this.activeControlledVocabularyEntry=this.navigate(this.displayedOptions,e,s,!0)}else this.navigateAutocomplete(t,e)},navigateAutocomplete(t,e){if(t.preventDefault(),this.resultListInt.length){const s=this.activeCollectionId,{key:i}=t;if(i==="ArrowDown"||i==="ArrowUp"){this.activeCollectionId||(this.activeCollectionId=this.resultListInt[0][this.autocompletePropertyNames.id]);const l=this.resultListInt.map(c=>c[this.autocompletePropertyNames.id]).indexOf(this.activeCollectionId);let r=this.consolidatedResultList[this.activeCollectionId];const a=e?1:-1,o=r.indexOf(this.activeEntry),n=this.isWithinArrayLimit(this.resultListInt,e,l+a);if(!this.collectionSelect&&this.isWithinArrayLimit(r,e,o+a))this.activeEntry=this.navigate(r,e,o);else if(!this.collectionSelect&&!e&&l===0&&o===0)this.activeEntry=null,this.activeCollectionId="";else if(n){this.activeCollectionId=this.resultListInt[l+a][this.autocompletePropertyNames.id],r=this.consolidatedResultList[this.activeCollectionId];const c=e||this.collectionSelect?0:r.length-1;this.activeEntry=r[c]}else!n&&l===this.resultListInt.length-1&&o===r.length-1?(this.activeCollectionId=this.resultListInt[0][this.autocompletePropertyNames.id],r=this.consolidatedResultList[this.activeCollectionId],[this.activeEntry]=r):!n&&l===0&&o===-1&&(this.activeCollectionId=this.resultListInt[this.resultListInt.length-1][this.autocompletePropertyNames.id],r=this.consolidatedResultList[this.activeCollectionId],[this.activeEntry]=r.slice(-1))}else i==="ArrowLeft"?this.collectionSelect=!0:i==="ArrowRight"&&(this.collectionSelect=!1);if(this.activeCollectionId&&!this.collectionSelect&&s!==this.activeCollectionId&&this.assistiveText.categoryAnnouncement){const l=this.autocompleteResults.find(({[this.autocompletePropertyNames.id]:r})=>r===this.activeCollectionId)[this.autocompletePropertyNames.label];this.announcement=this.assistiveText.categoryAnnouncement.replace("{label}",l)}}},handleDropDownOnTabKey(t){const e=this.$el.getElementsByTagName("input"),s=Array.from(e).filter(i=>i.id.includes("search"));if(e){const i=s.indexOf(t.target);(!t.shiftKey&&i>=s.length-1||t.shiftKey&&i<=0)&&(this.isActive=!1)}},handleDateInput(t){this.filter.type.includes("date")&&JSON.stringify(t)!==JSON.stringify(this.filter.filter_values)&&(this.currentInput=t,this.$set(this.filter,"filter_values",this.currentInput),this.isActive=!1)},setFilterValues(t,e={}){const s=e.filter_values,{type:i}=t,l=t.freetext_allowed;return i==="date"?e.type&&e.type.includes("date")&&s?s.date_from||s.date_to:"":i==="daterange"?e.type.includes("date")?{date_from:s&&(s.date_from||s)||"",date_to:s&&s.to?s.to:""}:{date_from:"",date_to:""}:i==="chips"&&l&&e.type==="chips"&&e.freetext_allowed?t.subsets&&t.subsets.includes(e[this.identifierPropertyName.filter])?s:s&&s.length?s.filter(r=>!r[this.identifierPropertyName.autocompleteOption]):[]:e.type==="text"&&s&&s.length&&s[0]&&i==="chips"&&l?[{[this.labelPropertyName.autocompleteOption]:s[0]}]:[]},resetAllInput(){this.currentInput="",this.activeEntry=null,this.activeCollectionId="",this.activeControlledVocabularyEntry=null},calcFadeOut(t){const e=t.target,s=e.scrollLeft,i=e.scrollWidth-e.clientWidth;this.filterFade={left:s!==0,right:s!==i}},onTab(t){t.shiftKey||(this.isActive=!1)},onClickedOutsideSearch(t){this.isActive=!1;const{type:e}=t;e==="touchstart"&&(this.stopSearchClick=!0,setTimeout(()=>{this.stopSearchClick=!1},500))},onSearchClick(t){this.stopSearchClick?(t.stopPropagation(),this.isActive=!1,this.stopSearchClick=!1):this.isActive=!0},initObservers(){const t=new MutationObserver(this.filterChangeObserverAction);t.observe(this.$refs.advancedSearchRow,{subtree:!0,childList:!0}),this.observer=t;const e=new ResizeObserver(this.resizeActions);e.observe(this.$refs.advancedSearchRow),this.resizeObserver=e},filterChangeObserverAction(){this.getSearchInputElement(),this.filter.type!==this.currentFilterType&&this.isActive&&this.searchInputElement&&(this.searchInputElement.focus(),this.currentFilterType=this.filter.type)},resizeActions(){const t=this.$refs.advancedSearchRow,e=this.$refs.baseSearch;if(e){const s=e.$el.clientWidth;this.$el.style.setProperty("--col-number",Math.floor((s-s/4)/180)||1)}if(t){const s=t.clientWidth;this.filterSlotName=s>=500?"pre-input-field":"input-field-addition-before"}},getSearchInputElement(){const t=this.$el.getElementsByTagName("input");t&&t.length&&(this.searchInputElement=Array.from(t).find(e=>e.id.includes("search-input")&&e.id.includes(this.searchRowId)))}}};var O=function(){var e=this,s=e._self._c;return s("div",{ref:"advancedSearchRow",staticClass:"base-advanced-search-row",on:{click:e.openDropDown}},[s("BaseSearch",e._g({ref:"baseSearch",class:["base-advanced-search-row__search",{"base-advanced-search-row__search__shadow":e.applyBoxShadow}],attrs:{id:"search-input-"+e.internalRowId,"show-pre-input-icon":e.isMainSearch&&e.filter[e.identifierPropertyName.filter]===e.defaultFilter[e.identifierPropertyName.filter],label:e.assistiveText.searchLabel||"Search for Entries",type:e.searchType,"selected-chips":e.selectedOptions,loadable:e.filter.type==="text"||e.filter.type==="chips","is-loading":e.isLoading,placeholder:e.placeholder,"drop-down-list-id":e.searchType==="controlled"?`controlled-options-${e.internalRowId}`:"autocomplete-options-"+e.internalRowId,language:e.language,"identifier-property-name":e.useAutocompleteFunctionality?e.identifierPropertyName.autocompleteOption:e.identifierPropertyName.controlledVocabularyOption,"label-property-name":e.useAutocompleteFunctionality?e.labelPropertyName.autocompleteOption:e.labelPropertyName.controlledVocabularyOption,"is-active":e.isActive,"set-focus-on-active":!1,clearable:!1,"assistive-text":{selectedOption:e.assistiveText.selectedOption,loaderActive:e.assistiveText.loaderActive,results:e.assistiveText.results},"date-field-delay":e.dateFieldDelay,"linked-list-option":e.activeEntry?e.collectionSelect?e.activeCollectionId:e.activeEntry[e.identifierPropertyName.autocompleteOption]:e.activeControlledVocabularyEntry?e.activeControlledVocabularyEntry[e.identifierPropertyName.controlledVocabularyOption]:void 0},on:{"update:selectedChips":function(i){e.selectedOptions=i},"update:selected-chips":function(i){e.selectedOptions=i},"update:isActive":function(i){e.isActive=i},"update:is-active":function(i){e.isActive=i},"clicked-outside":e.onClickedOutsideSearch,keydown:[e.handleKeyDownEvent,function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"up",38,i.key,["Up","ArrowUp"])&&e._k(i.keyCode,"down",40,i.key,["Down","ArrowDown"])&&e._k(i.keyCode,"right",39,i.key,["Right","ArrowRight"])&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&i.button!==2||"button"in i&&i.button!==0?null:e.navigateDropDown.apply(null,arguments)},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"tab",9,i.key,"Tab")?null:e.handleDropDownOnTabKey.apply(null,arguments)},function(i){if(!i.type.indexOf("key")&&e._k(i.keyCode,"esc",27,i.key,["Esc","Escape"]))return null;e.isActive=!1}],"!keydown":function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.selectOptionOnKeyEnter.apply(null,arguments)},"value-validated":e.handleDateInput},nativeOn:{click:function(i){return e.onSearchClick.apply(null,arguments)}},scopedSlots:e._u([{key:e.filterSlotName,fn:function(){return[e.mode==="list"?s("BaseChipsInputField",{class:["base-advanced-search-row__first-column",{"base-advanced-search-row__first-column__small":e.filterSlotName==="input-field-addition-before"},"base-advanced-search-row__filter-input",{hide:e.isMainSearch&&e.filter[e.identifierPropertyName.filter]===e.defaultFilter[e.identifierPropertyName.filter]},{"base-advanced-search-row__filter-input__date":e.filter.type.includes("date")}],attrs:{id:"search-filter-select-"+e.internalRowId,"selected-list":e.selectedFilter,"allow-multiple-entries":!1,"allow-unknown-entries":!1,"allow-dynamic-drop-down-entries":!1,"linked-list-option":e.activeFilter?`filter-option-${e.activeFilter[e.identifierPropertyName.filter]}`:null,"use-form-field-styling":!1,"show-input-border":!1,"show-label":!1,label:e.assistiveText.selectFilterLabel||"Select filter",language:e.language,"drop-down-list-id":"filter-options-"+e.internalRowId,"identifier-property-name":e.identifierPropertyName.filter,"label-property-name":e.labelPropertyName.filter,"input-class":e.filterSlotName==="input-field-addition-before"?"":"base-advanced-search-row__input-field"},on:{"update:selectedList":function(i){e.selectedFilter=i},"update:selected-list":function(i){e.selectedFilter=i},click:function(i){e.isActive=!0},keydown:[e.handleKeyDownEvent,function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"tab",9,i.key,"Tab")?null:e.handleDropDownOnTabKey.apply(null,arguments)},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.selectFilter(e.activeFilter)},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"up",38,i.key,["Up","ArrowUp"])&&e._k(i.keyCode,"down",40,i.key,["Down","ArrowDown"])?null:e.navigateFilters.apply(null,arguments)}]},scopedSlots:e._u([{key:"chip",fn:function({entry:i}){return[s("span",{key:"chip-"+i.idInt,staticClass:"base-advanced-search-row__selected-filter-label",attrs:{id:i.idInt}},[e._v(" "+e._s(`#${e.getLangLabel(i[e.labelPropertyName.filter],!0)}`)+" ")])]}}],null,!1,3344849930)}):e._e()]},proxy:!0},{key:"post-input-field",fn:function(){return[!e.isMainSearch||e.filterHasValues||e.filter.type==="text"&&e.currentInput?s("button",{class:["base-advanced-search-row__icon-button",{"base-advanced-search-row__icon-button__date":e.filter.type.includes("date")}],on:{keydown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"tab",9,i.key,"Tab")?null:e.onTab.apply(null,arguments)},focusin:function(i){i.stopPropagation(),i.preventDefault()},click:function(i){return i.stopPropagation(),i.preventDefault(),e.removeFilter.apply(null,arguments)}}},[s("BaseIcon",{staticClass:"base-advanced-search-row__search-row-icon",attrs:{title:e.assistiveText.removeFilter||"Remove filter",name:"remove"}})],1):e._e(),e._t("after")]},proxy:!0},{key:"below-input",fn:function(){return[e.isActive?s("BaseDropDownList",{ref:"dropDown",staticClass:"base-advanced-search-row__drop-down-body",attrs:{"drop-down-options":e.resultListInt,"active-option":{[e.autocompletePropertyNames.id]:e.activeCollectionId},"list-id":"autocomplete-options-"+e.internalRowId,"active-styled":!1,"has-sub-options":!0,"display-as-drop-down":!1,"use-custom-option-active-background-color":!0,language:e.language,"identifier-property-name":e.autocompletePropertyNames.id,"label-property-name":e.autocompletePropertyNames.data,"list-body-style":{"max-height":"400px","overflow-y":"auto"}},nativeOn:{touchstart:function(i){i.stopPropagation()},click:function(i){i.stopPropagation()}},scopedSlots:e._u([e.mode==="list"?{key:"before-list",fn:function(){return[s("div",{class:["base-advanced-search-row__above-list-area","base-advanced-search-row__area-padding",{"base-advanced-search-row__above-list-area-filters":e.filter.type==="text"||e.filter.type==="chips"}]},[s("div",{staticClass:"base-advanced-search-row__filter-area-wrapper"},[s("div",{staticClass:"base-advanced-search-row__first-column base-advanced-search-row__filter-area"},[s("div",{staticClass:"base-advanced-search-row__filter-area-header"},[s("div",{staticClass:"base-advanced-search-row__filter-text"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.advancedSearchText.title)))+" ")]),s("div",{staticClass:"base-advanced-search-row__filter-subtext"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.advancedSearchText.subtext)))+" ")])]),s("span",{staticClass:"base-advanced-search-row__filter-area-close",on:{keydown:function(i){if(!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter"))return null;e.isActive=!1},click:function(i){i.stopPropagation(),e.isActive=!1}}},[s("BaseIcon",{staticClass:"rotate-180 base-advanced-search-row__filter-area-close-icon",attrs:{name:"drop-down"}})],1)]),s("div",{class:["base-advanced-search-row__columns","base-advanced-search-row__filter-list-wrapper",{"base-advanced-search-row__filter-list-wrapper__fade-right":e.filterFade.right},{"base-advanced-search-row__filter-list-wrapper__fade-left":e.filterFade.left}]},[s("ul",{ref:"filterBox",staticClass:"base-advanced-search-row__filter-list",attrs:{id:"filter-options-"+e.internalRowId,role:"listbox"}},e._l(e.displayFilterList,function(i,l){return s("li",{key:l,ref:"filterOption",refInFor:!0,staticClass:"base-advanced-search-row__filter base-advanced-search-row__column-item",class:[{"base-advanced-search-row__filter-active":e.activeFilter===i},{"base-advanced-search-row__filter-selected":e.filter&&e.filter[e.identifierPropertyName.filter]===i[e.identifierPropertyName.filter]}],attrs:{id:`filter-option-${i[e.identifierPropertyName.filter]}`,"aria-selected":(e.filter&&e.filter[e.identifierPropertyName.filter]===i[e.identifierPropertyName.filter]).toString(),tabindex:"-1",role:"option"},on:{keydown:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:(r.stopPropagation(),e.selectFilter(i))},click:function(r){return r.stopPropagation(),e.selectFilter(i)}}},[e._v(" "+e._s(`#${i[e.labelPropertyName.filter]}`)+" ")])}),0)])])])]},proxy:!0}:null,{key:"option",fn:function({option:i}){return[!e.filter||e.useAutocompleteFunctionality?s("div",{staticClass:"base-advanced-search-row__autocomplete-body"},[i[e.autocompletePropertyNames.data].length?s("div",{class:["base-advanced-search-row__first-column","base-advanced-search-row__autocomplete-collection"]},[s("div",{staticClass:"base-advanced-search-row__autocomplete-collection-text"},[e._v(" "+e._s(i[e.autocompletePropertyNames.label])+" "),e.assistiveText.optionsAnnouncement?s("span",{staticClass:"hide"},[e._v(e._s(e.assistiveText.optionsAnnouncement.replace("{number}",i[e.autocompletePropertyNames.data].length)))]):e._e()])]):e._e(),s("BaseDropDownList",{staticClass:"base-advanced-search-row__autocomplete-options",attrs:{"drop-down-options":i[e.autocompletePropertyNames.data],"active-option":e.activeCollectionId===i[e.autocompletePropertyNames.id]?e.activeEntry:{},"display-as-drop-down":!1,"list-id":"autocomplete-options-"+e.internalRowId,language:e.language,"identifier-property-name":e.identifierPropertyName.autocompleteOption,"label-property-name":e.labelPropertyName.autocompleteOption,"use-highlight-string-match":e.highlightAutocompleteMatch,"highlight-string-tags":e.highlightAutocompleteTags,"highlight-string-match":e.currentInput},on:{"update:selected-option":function(l){return e.addOption(l,i[e.autocompletePropertyNames.id])}},scopedSlots:e._u([{key:"option",fn:function({option:l}){return[e._t("autocomplete-option",null,{option:l,collectionId:i[e.autocompletePropertyNames.id]})]}}],null,!0)})],1):e._e()]}},e.filter.type==="chips"&&!e.filter.freetext_allowed?{key:"after-list",fn:function(){return[s("div",{staticClass:"base-advanced-search-row__above-list-area base-advanced-search-row__chips-area base-advanced-search-row__area-padding"},[s("div",{class:["base-advanced-search-row__chips-row",{"base-advanced-search-row__chips-row__no-options":e.filter.type==="chips"&&!e.displayedOptions.length}]},[s("div",{staticClass:"base-advanced-search-row__controlled-options-title base-advanced-search-row__first-column"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.advancedSearchText.availableOptions)))+" ")]),e.controlledVocabularyOptions&&e.displayedOptions.length&&(e.displayedOptions.length<=e.maxNumberControlledOptions||e.currentInput&&e.currentInput.length>=4)?s("ul",{staticClass:"base-advanced-search-row__chips-list base-advanced-search-row__columns",attrs:{id:`controlled-options-${e.internalRowId}`,role:"listbox"}},e._l(e.displayedOptions,function(i){return s("li",{key:i[e.identifierPropertyName.controlledVocabularyOption],staticClass:"base-advanced-search-row__column-item",attrs:{id:i[e.identifierPropertyName.controlledVocabularyOption],value:i[e.labelPropertyName.controlledVocabularyOption],"aria-selected":(e.activeControlledVocabularyEntry&&i[e.identifierPropertyName.controlledVocabularyOption]===e.activeControlledVocabularyEntry[e.identifierPropertyName.controlledVocabularyOption]||!1).toString(),role:"option",tabindex:"0"},on:{mouseenter:function(l){e.activeControlledVocabularyEntry=i},focusin:function(l){e.activeControlledVocabularyEntry=i},mouseleave:function(l){e.activeControlledVocabularyEntry=null},focusout:function(l){e.activeControlledVocabularyEntry=null}}},[s("BaseChip",{staticClass:"base-advanced-search-row__option-chip",attrs:{"is-removable":!1,entry:e.getLangLabel(i[e.labelPropertyName.controlledVocabularyOption]),"chip-active":e.activeControlledVocabularyEntry&&i[e.identifierPropertyName.controlledVocabularyOption]===e.activeControlledVocabularyEntry[e.identifierPropertyName.controlledVocabularyOption]},on:{clicked:function(l){return e.addOption(i)}}})],1)}),0):e.isLoading?s("div",{staticClass:"base-advanced-search-row__no-options base-advanced-search-row__area-padding"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.chipsOngoing,!0)))+" ")]):e.displayedOptions.length>e.maxNumberControlledOptions&&(!e.currentInput||e.currentInput.length<4)?s("div",{staticClass:"base-advanced-search-row__no-options base-advanced-search-row__area-padding"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.chipsMaxOptions,!0)))+" ")]):e.currentInput&&e.currentInput.length&&!e.displayedOptions.length?s("div",{staticClass:"base-advanced-search-row__no-options base-advanced-search-row__area-padding"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.chipsNoMatch,!0)))+" ")]):e.displayedOptions.length?e._e():s("div",{staticClass:"base-advanced-search-row__no-options base-advanced-search-row__area-padding"},[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.chipsNoOptions,!0)))+" ")])])])]},proxy:!0}:null,{key:"no-options",fn:function(){return[e.useAutocompleteFunctionality?s("div",{class:["base-advanced-search-row__no-options",{"base-advanced-search-row__no-options-hidden":!e.useAutocompleteFunctionality}]},[!e.currentInput||typeof e.currentInput=="string"&&!e.currentInput.trim()?s("div",[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.autocompleteInitial,!0)))+" ")]):e.isLoading?s("div",[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.autocompleteOngoing,!0)))+" ")]):s("div",[e._v(" "+e._s(e.getI18nTerm(e.getLangLabel(e.dropDownInfoTexts.autocompleteNoOptions,!0)))+" ")])]):e._e()]},proxy:!0}],null,!0)}):e._e(),e._t("below")]},proxy:!0}],null,!0),model:{value:e.currentInput,callback:function(i){e.currentInput=i},expression:"currentInput"}},e.$listeners)),e.mode==="list"&&e.isMainSearch?s("BaseButton",{class:["base-advanced-search-row__add-filter-button",{"base-advanced-search-row__add-filter-button__shadow":e.applyBoxShadow}],attrs:{icon:"plus","button-style":"row","icon-position":"right"},on:{clicked:e.addFilterRow},nativeOn:{click:function(i){i.stopPropagation()}},scopedSlots:e._u([{key:"text",fn:function({labelId:i}){return[s("span",{staticClass:"base-advanced-search-row__add-filter-button__text",attrs:{id:i}},[e._v(" "+e._s(e.assistiveText.addFilter||"Add filter")+" ")])]}}],null,!1,773239955)}):e._e()],1)},N=[],x=w.default(I,O,N,!1,null,"5e56cf87",null,null);const P=x.exports;exports.default=P;
//# sourceMappingURL=BaseAdvancedSearchRow.vue.cjs.js.map
