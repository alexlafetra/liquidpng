"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const n=require("vuedraggable"),l=require("vue"),s=require("../../composables/useAnnouncer.cjs.js"),d=require("../BaseIcon/BaseIcon.vue.cjs.js"),p=require("../BaseChipsInput/BaseChipsInput.vue.cjs.js"),u=require("../BaseChip/BaseChip.vue.cjs.js");require("./BaseChipsBelow.vue.cjs2.js");const c=require("../../_virtual/_plugin-vue2_normalizer.cjs.js"),h={name:"BaseChipsBelow",components:{BaseChipsInput:p.default,Draggable:n,BaseChip:u.default,BaseIcon:d.default},model:{prop:"selectedList",event:"selected-changed"},props:{list:{type:Array,default:()=>[]},selectedList:{type:Array,default:()=>[]},id:{type:String,default:""},label:{type:String,required:!0},showLabel:{type:Boolean,default:!0},placeholder:{type:String,default:null},dropDownNoOptionsInfo:{type:String,default:"No options available"},allowUnknownEntries:{type:Boolean,default:!1},allowMultipleEntries:{type:Boolean,default:!0},allowDynamicDropDownEntries:{type:Boolean,default:!1},addSelectedEntryDirectly:{type:Boolean,default:!0},additionalPropAllowMultipleEntries:{type:Boolean,default:!0},additionalPropOptions:{type:Array,default:()=>[]},additionalPropDefaultOption:{type:[Object,null],default:null},additionalPropRequired:{type:Boolean,default:!1},additionalPropPlaceholder:{type:String,default:"Select role(s)"},validationTexts:{type:Object,default:()=>({required:"Select an option."}),validator:t=>["required"].every(e=>Object.keys(t).includes(e))},hoverboxContent:{type:Object,default:()=>({})},isLoading:{type:Boolean,default:!1},sortText:{type:String,default:"Sort A â€“ Z"},sortName:{type:Boolean,default:!1},language:{type:String,default:""},addNewChipText:{type:String,default:""},identifierPropertyName:{type:String,default:"id"},labelPropertyName:{type:String,default:"label"},additionalPropertyName:{type:String,default:"roles"},required:{type:Boolean,default:!1},invalid:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},errorMessage:{type:String,default:""},showErrorIcon:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},closeDropdownOnOptionSelect:{type:Boolean,default:!0},inputClass:{type:String,default:""},sortable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},highlightStringMatch:{type:Boolean,default:!1},highlightStringTags:{type:Array,default:()=>[]},assistiveText:{type:Object,default:()=>({loaderActive:"loading.",resultsRetrieved:"{number} options in drop down.",optionAdded:"option {label} added to selected list.",optionRemoved:"option {label} removed."})}},setup(){const t=l.ref(null),{announcement:e}=s.useAnnouncer(t);return{chipsBelow:t,announcement:e}},data(){return{chipsArray:[],selectedBelowListInt:[],chipActive:-1,invalidInt:!1,errorMessageInt:"",additionalPropErrors:[]}},computed:{chipsInputProps(){const t={...this.$props};return delete t.language,delete t.additionalPropOptions,delete t.additionalPropPlaceholder,delete t.additionalPropertyName,t},isDragDropCapable(){return window?!(navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("CriOS")===-1)&&"DragEvent"in window:!1}},watch:{selectedList:{handler(t){this.createInternalList(t),t.length&&(this.invalidInt=this.invalid,this.errorMessageInt=this.errorMessage),this.allowUnknownEntries&&this.additionalPropErrors.length&&(this.additionalPropErrors=[])},immediate:!0},invalid:{handler(t){this.invalidInt=t},immediate:!0},errorMessage:{handler(t){this.errorMessageInt=t},immediate:!0},required:{handler(t){t||(this.invalidInt=this.invalid,this.errorMessageInt=this.errorMessage)}},additionalPropRequired:{handler(t){t||(this.additionalPropErrors=[])}}},methods:{addedEntry(t){this.emitInternalList(t.map(e=>typeof e=="object"?{...e,[this.additionalPropertyName]:e[this.additionalPropertyName]||[]}:{[this.labelPropertyName]:e,[this.additionalPropertyName]:e[this.additionalPropertyName]||[]}))},removeEntry(t,e){const r=this.selectedBelowListInt.splice(e,1);this.$set(r,this.additionalPropertyName,{}),this.emitInternalList(this.selectedBelowListInt),this.announcement=this.assistiveText.optionRemoved.replace("{label}",r[0][this.labelPropertyName])},updateList(t,e){this.emitInternalList(e)},updateAdditionalProperty(t,e){this.$set(this.selectedBelowListInt[e],this.additionalPropertyName,t),this.emitInternalList(this.selectedBelowListInt),this.isValidAdditionalOptions(this.selectedBelowListInt[e]),this.$emit("additional-property-changed",this.selectedList[e])},createInternalList(t){this.selectedBelowListInt=t.map((e,r)=>typeof e=="object"?{[this.additionalPropertyName]:[],idInt:this.identifierPropertyName&&(e[this.identifierPropertyName]===0||e[this.identifierPropertyName])?e[this.identifierPropertyName]:e[this.labelPropertyName]+r,...e}:{[this.labelPropertyName]:e,idInt:this.list.length+r,[this.additionalPropertyName]:[]})},emitInternalList(t){const e=[];t.forEach((r,i)=>this.$set(e,i,{...r})),e.forEach(r=>this.$delete(r,"idInt")),this.$emit("selected-changed",e)},modifyChipValue(t,e){if(!t)this.selectedBelowListInt.splice(e,1);else{const r={...this.selectedBelowListInt[e]};this.identifierPropertyName&&this.$set(r,this.identifierPropertyName,""),this.$set(r,this.labelPropertyName,t),this.$set(this.selectedBelowListInt,e,r)}this.emitInternalList(this.selectedBelowListInt)},fetchDropDownEntries(t){this.$emit("fetch-dropdown-entries",t)},hoverBoxActive(t,e){this.$emit("hoverbox-active",{value:t,entry:e})},additionalOptionsErrorMessage(t,e){return this.additionalPropErrors.filter(r=>r.id===t).length||typeof this.additionalPropErrors[e]<"u"?this.validationTexts.required:""},isChipsRemovable(t){return!this.additionalPropRequired||!!this.additionalPropAllowMultipleEntries&&t.length>1},isValidChipsInput(){return this.required?this.selectedList.length?!0:(this.invalidInt=!0,this.errorMessageInt=`${this.errorMessage} ${this.validationTexts.required}`.trim(),!1):!0},isInvalidAdditionalOption(t,e){return!!this.additionalPropErrors.filter(r=>r.id===t).length||typeof this.additionalPropErrors[e]<"u"},isValidAdditionalOptions(t){return this.additionalPropRequired?t&&t[this.additionalPropertyName].length?(this.additionalPropErrors=this.additionalPropErrors.filter(e=>e.id!==t.id),!0):(this.additionalPropErrors=this.selectedList.filter(e=>!e[this.additionalPropertyName]||!e[this.additionalPropertyName].length).map(e=>({id:e.id})),this.selectedBelowListInt.length?!this.additionalPropErrors.length:!0):!0},validate(){this.invalidInt=this.invalid,this.errorMessageInt=this.errorMessage,this.additionalPropErrors=[];const t=this.isValidChipsInput(),e=this.isValidAdditionalOptions(null);return!(t&&e)}}};var f=function(){var e=this,r=e._self._c;return r("div",{ref:"chipsBelow",staticClass:"base-chips-below"},[r("BaseChipsInput",e._b({ref:"chipsInput",attrs:{"close-dropdown-on-option-select":e.closeDropdownOnOptionSelect,"is-loading":e.isLoading,"display-chips-inline":!1,"sort-text":e.sortText,"sort-name":e.sortName,invalid:e.invalidInt,"error-message":e.errorMessageInt},on:{"selected-changed":e.addedEntry,"fetch-dropdown-entries":e.fetchDropDownEntries},scopedSlots:e._u([{key:"drop-down-entry",fn:function(i){return[e._t("drop-down-entry",null,{item:i.item})]}},{key:"label-addition",fn:function(){return[e._t("label-addition")]},proxy:!0},{key:"input-field-addition-before",fn:function(){return[e._t("input-field-addition-before")]},proxy:!0},{key:"input-field-addition-after",fn:function(){return[e._t("input-field-addition-after")]},proxy:!0},{key:"post-input-field",fn:function(){return[e._t("post-input-field")]},proxy:!0},{key:"error-icon",fn:function(){return[e._t("error-icon")]},proxy:!0},{key:"remove-icon",fn:function(){return[e._t("remove-icon")]},proxy:!0},{key:"no-options",fn:function(){return[e._t("no-options")]},proxy:!0},{key:"below-input",fn:function(){return[e._t("below-input")]},proxy:!0}],null,!0),model:{value:e.selectedBelowListInt,callback:function(i){e.selectedBelowListInt=i},expression:"selectedBelowListInt"}},"BaseChipsInput",e.chipsInputProps,!1)),r("draggable",{attrs:{animation:200,"force-fallback":!e.isDragDropCapable,"fallback-on-body":!e.isDragDropCapable,group:{name:"people"},handle:".base-chips-below-list-icon-wrapper"},on:{end:function(i){return e.updateList(i,e.selectedBelowListInt)}},model:{value:e.selectedBelowListInt,callback:function(i){e.selectedBelowListInt=i},expression:"selectedBelowListInt"}},e._l(e.selectedBelowListInt,function(i,o){return r("div",{key:"item"+i.idInt,class:["base-chips-below-list-item",{"base-chips-below-list-item--draggable":e.draggable}],attrs:{name:i[e.labelPropertyName]},on:{mousedown:function(a){e.chipActive=o}}},[r("div",{key:"line"+i.idInt,staticClass:"base-chips-below-list-item-line"},[e.draggable?r("div",{key:"iconwrapper"+i.idInt,staticClass:"base-chips-below-list-icon-wrapper"},[r("base-icon",{key:"icon"+i.idInt,staticClass:"svg-icon base-chips-below-list-icon",attrs:{name:"drag-lines"}})],1):e._e(),r("div",{key:"chip-wrapper"+i.idInt,staticClass:"base-chips-below-list-item-chip-wrapper"},[r("BaseChip",{key:"chip"+i.idInt,ref:"selectedChip",refInFor:!0,staticClass:"base-chips-input-chip",attrs:{id:"chips-below"+o,"is-linked":!i.edited&&(i[e.identifierPropertyName]===0||!!i[e.identifierPropertyName]),"hover-box-content":e.hoverboxContent},on:{"value-changed":function(a){return e.modifyChipValue(a,o)},"hoverbox-active":function(a){return e.hoverBoxActive(a,i)},"remove-entry":function(a){return e.removeEntry(a,o)}},model:{value:i[e.labelPropertyName],callback:function(a){e.$set(i,e.labelPropertyName,a)},expression:"entry[labelPropertyName]"}})],1),r("BaseChipsInput",{key:"input_"+i.idInt,staticClass:"base-chips-below-chips-input",attrs:{id:`${e.id}_${e.additionalPropertyName}_${i[e.identifierPropertyName]||i.idInt}`,"show-label":!1,label:e.label+"-"+e.additionalPropertyName,list:e.additionalPropOptions,"show-input-border":!1,"allow-dynamic-drop-down-entries":!1,placeholder:e.additionalPropPlaceholder,"always-linked":!0,language:e.language,draggable:!0,"drop-down-no-options-info":e.dropDownNoOptionsInfo,"identifier-property-name":e.identifierPropertyName,"label-property-name":e.labelPropertyName,invalid:e.isInvalidAdditionalOption(i[e.labelPropertyName],o),"error-message":e.additionalOptionsErrorMessage(i[e.labelPropertyName],o),"allow-multiple-entries":e.additionalPropAllowMultipleEntries,"chips-removable":e.isChipsRemovable(i[e.additionalPropertyName]),"show-error-icon":e.showErrorIcon,required:e.additionalPropRequired,"default-entry":e.additionalPropDefaultOption},on:{"selected-changed":function(a){return e.updateAdditionalProperty(a,o)}},model:{value:i[e.additionalPropertyName],callback:function(a){e.$set(i,e.additionalPropertyName,a)},expression:"entry[additionalPropertyName]"}})],1)])}),0)],1)},m=[],y=c.default(h,f,m,!1,null,null,null,null);const g=y.exports;exports.default=g;
//# sourceMappingURL=BaseChipsBelow.vue.cjs.js.map
