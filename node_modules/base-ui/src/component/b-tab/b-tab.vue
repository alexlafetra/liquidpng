<!-- @author Kyles Light -->
<!-- @email kuilin@yangqianguan.com -->
<!-- @date 2018-07-26 13:08:08.298 -->
<!-- @desc generated by yqg-cli@0.2.4 -->

<template>

    <div class="b-tab">
        <ul class="b-tab-wrap">
            <li
                v-for="(item, index) in list"
                :key="item.key"
                :class="{active: index === activeIndex}"
                class="b-tab-item"
                @click="tap(item, index)">
                <slot :active="index === activeIndex" :item="item">
                    {{ item.label }}
                </slot>
            </li>
        </ul>
    </div>

</template>

<script type="text/babel">

    export default {
        name: 'BTab',

        props: {
            list: {
                type: Array,
                required: true
            },

            defaultIndex: {
                type: Number,
                default: 0
            },

            value: {
                type: String,
                default: ''
            }
        },

        data() {
            return {
                activeIndex: 0
            };
        },

        watch: {
            value(val) {
                const vm = this;

                const target = vm.list.filter(item => item.key === val)[0];
                const activeIndex = target ? vm.list.indexOf(target) : 0;

                vm.activeIndex = activeIndex;
                vm.$emit('input', val);
            }
        },

        mounted() {
            const vm = this;
            const {defaultIndex} = vm;

            if (defaultIndex > -1) {
                vm.activeIndex = defaultIndex;
            }
        },

        methods: {
            tap(item, index) {
                const vm = this;
                vm.activeIndex = index;
                vm.$emit('input', item.key);
                vm.$emit('tap', item, index);
            }
        }
    };

</script>

